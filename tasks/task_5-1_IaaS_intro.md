# Домашнее задание к занятию "5.1. Введение в виртуализацию. Типы и функции гипервизоров. Обзор рынка вендоров и областей применения."
Q1: Опишите кратко, как вы поняли: в чем основное отличие полной (аппаратной) виртуализации, паравиртуализации и виртуализации на основе ОС.  
A1:
- полная или аппаратная виртуализация подразумевает, что ОС внутри виртуальной машины работает с "железом" хоста через гипервизор, т.е. между драйверами/ядром ОС внутри ВМ и реальным железом есть только гипервизор.
- виртуализация на основе ОС подразумевает, что доступ к железу имеет только ОС хоста, а ОС внутри ВМ получают доступ к реурсам через гипервизор, который в свою очередь обращается к ОС хоста.
- паравиртуализация подразумевает, что гипервизор сам не может обеспечить доступ к аппаратным ресурсам, за него эту роль должна реализовать ОС хоста, но при этом ВМ строятся на основе специально модифицированных ядер, способных работать в виртуализированной середе. Последняя особенность ограничивает круг ОС, используемых в ВМ, системами с открытым исходным кодом (для модификации).
---
Q2: Выберите один из вариантов использования организации физических серверов, в зависимости от условий использования.
Организация серверов:
- физические сервера,  
- паравиртуализация,  
- виртуализация уровня ОС.  

Q2.1: Высоконагруженная база данных, чувствительная к отказу.  
A2.1: Выделил бы отдельный физический сервер. Дорого, не эффективно, когда нагрузки нет, но при большой нагрузке и чувствительности к потере данных лучше пусть будет чуть дороже каждый месяц, чем раз в 5 лет терять клиентов, а может они и после первого раза уйдут навсегда. 

Q2.2: Различные web-приложения.  
A2.2: Раз уж приложения различные, то я выберу паравиртуализацию, мало ли какие ресурсы потребуются этим web-приложениям. Если заранее известно, что ничего специфичного приложения делать не будут (рассчеты на GPU, высококачественные генераторы случайных чисел), то можно ограничиться уровнем ОС. 

Q2.3: Windows системы для использования бухгалтерским отделом.  
A2.3: Выберу систему от MS - Hyper-V, т.к. она ориентирована на ОС Windows. Если бухгалтерия тяжелая, то надо разворачивать в режиме аппаратной виртуализации, если нет, то можно ограничиться паравиртуализацией. Возможно, сама бухгалтерская программа м.б. доступна как SaaS?!

Q2.4: Системы, выполняющие высокопроизводительные расчеты на GPU.
A2.4: Там, где нужна производительность, лучше не иметь лишних посредников между софтом и железом - физический сервер.
---

Q3: Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

Сценарии:

Q3.1: 100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий.  
A3.1: Hyper-V, т.к. этот гипервизор ориентирован на Windows-based системы, обеспечивает репликацию  (не только данных), создание резрвных копий.  

Q3.2: Требуется наиболее производительное бесплатное open source решение для виртуализации небольшой (20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.  
A3.2: Пусть будет XEN: 
  - распространяется по лицензии GPL
  - работает практически без потерь производительности
  - хорош как для Linux, так и для Windows

Q3.3: Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows инфраструктуры.  
A3.3: Максимально совместимое и производительное для Windows - Hyper-V.  

Q3.4: Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.  
A3.4: Несколько дистрибутивов Linux и тестирование чего-то нового удобно делать с помощью KVM, т.к. он ориентирован на Linux, он имеет кучу встроенных фитч. Достаточно прост, чтобы разработчики ПО под Linux сами настроили себе тестовый контур.
---

Q4: Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был выбор, то создавали бы вы гетерогенную среду или нет? Мотивируйте ваш ответ примерами.  
A4: 
- несколько разных систем виртуализации, параллельно работающие с одним и тем же железом на физическом уровне, - это фантастика. Им самим потребуется какой-то низкоуровневый гипервизор.
- при наличии низкоуровневого гипервизора (например ОС), скорее всего будут возникать проблемы конкуренции за ресурсы, т.к. не зная друг о друге, разнородные гипервизоры не смогут баллансировать нагрузку адекватно.
- стек из разных гипервизоров (матрешка)?! Зачем? Есть много разумных принципов разработки конструкции/архитектуры чего-либо: KISS, бритва Окама, разделение ответственности. Я даже за большие деньги не могу (пока нет опыта) сгенерировать сценарий, где было бы разумно использовать несколько систем виртуализации в пределах одной среды.
- а вот отдельно виртуализировать однородные ресурсы (сеть, хранилище, GPU) - вот это уже интересно, мне кажется. Но повторюсь, опыта ноль, своей фантазие чужой бизнесс я не доверю, если только не попросят:)
